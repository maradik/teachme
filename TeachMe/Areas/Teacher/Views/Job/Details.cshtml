@model TeachMe.ViewModels.Jobs.JobDetailsViewModel

@{
    ViewBag.Title = "Задача: " + Html.Encode(Model.Job.Title);
}

<h2>Задача: @Model.Job.Title</h2>

<div>
    @Html.Partial("_JobActions", Tuple.Create(Model.Job.Id, Model.JobAvailableActions))
</div>

<div>
    <hr/>
    @Html.Partial("_JobInfo", Model.Job)
</div>

<div>
    @using (Html.BeginForm("Take", "Job"))
    {
        @Html.AntiForgeryToken()

        <div class="form-actions no-color">
            @Html.Hidden("Id", Model.Job.Id)
            @if (string.IsNullOrEmpty(Model.Job.TeacherUserId))
            {
                <input type="submit" value="Взять в работу" class="btn btn-default"/>
            }
            @Html.ActionLink("Список моих задач", "Index") |
            @Html.ActionLink("Список доступных задач", "IndexAvailable")
        </div>
    }
</div>

@if (!string.IsNullOrEmpty(Model.Job.TeacherUserId))
{
    <h3>Обсуждение с заказчиком</h3>

    <div id="jobMessageContainer"></div>
    <div id="newJobMessageContainer">
        @Html.Action("_CreateMessage", "JobChat", new { JobId = Model.Job.Id, area = "" })
    </div>

    <script type="text/javascript">
        $(function () {
            autoLoadNewMessages();
        });
    </script>
}
